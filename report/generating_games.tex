\subsection{Introduction and basic definitions}

In the last section, we showed how to implement MCTS (or more specifically: UCT), which can be used directly to play games in a probabilistic manner.
The plan is to try it out on many different games.
In order to do that, we have to generate the games themselves.
The goal of this chapter is to show how to do just that.

This section talks about computationally generating positional games, given some parameters of said games, which we will cover later.
Since we will use a tool called Nauty to generate games, and since Nauty talks about graphs, it is slightly more appropriate to talk about hyper-graphs in place of positional games.

\begin{definition}
  A \emph{hypergraph} is a set of \emph{vertices}, $V$, together with a list of \emph{hyperedges} $E$, which are simply non-empty subsets of $V$.
\end{definition}

A positional game is equivalent to a hypergraph, if we take the so-called winning sets to be the hyperedges.

\subsection{Nauty and hypergraphs}


Nauty is a tool to generate and work with graphs, and can be downloaded at http://cs.anu.edu.au/people/bdm/nauty/.
We are particularly interested in the tools \texttt{genbg} and \texttt{showg}.

\texttt{genbg} is used to generate (non-isomorphic) bipartite graphs. By default it will output the graphs in the very compact g6 format.
\texttt{showg} is used to turn these g6-formatted graphs into more human-readable form.

A bipartite graph corresponds to a hypergraph in the following manner.
Let us say that the two colors are red and blue. Then we can decide that the red vertices correspond exactly with the set of vertices in our hypergraph.
We can make the blue vertices correspond to hyperedges by defining the hyper edge for a given blue vertex as those red vertices which are connected to it.


\subsection{Choosing the command line switches}
\label{sec:nautycommandline}

In this section, we work out as an example all of the hypergraphs with 2 vertices and 3 hyperedges, using Nauty.
I will assume that Nauty has been installed and your current directory is wherever you installed Nauty or have \texttt{genbg} and \texttt{showg} available.

Here is the command to generate the bipartite graphs.

\begin{code}
   $ ./genbg 2 3 | ./showg
\end{code}

The output (in tabular form here, for compactness) is as follows:

\begin{tabular}{|p{1.5in} | p{1.5in} | p{1.5in} |}
\begin{minipage}{1.5in}
\begin{output}
Graph 1, order 5.
0 : ;
1 : ;
2 : ;
3 : ;
4 : ;

\end{output}
\end{minipage}
&
\begin{minipage}{1.5in}
\begin{output}
Graph 5, order 5.
0 : 3;
1 : 4;
2 : ;
3 : 0;
4 : 1;

\end{output}
\end{minipage}
& 
\begin{minipage}{1.5in}
\begin{output}
Graph 9, order 5.
0 : 2 3 4;
1 : 4;
2 : 0;
3 : 0;
4 : 0 1;

\end{output}
\end{minipage}
\\
\begin{minipage}{1.5in}
\begin{output}
Graph 2, order 5.
0 : 4;
1 : ;
2 : ;
3 : ;
4 : 0;

\end{output}
\end{minipage}
&
\begin{minipage}{1.5in}
\begin{output}
Graph 6, order 5.
0 : 3 4;
1 : 4;
2 : ;
3 : 0;
4 : 0 1;

\end{output}
\end{minipage}
&
\begin{minipage}{1.5in}
\begin{output}
Graph 10, order 5.
0 : 2 4;
1 : 3;
2 : 0;
3 : 1;
4 : 0;

\end{output}
\end{minipage}
\\
\begin{minipage}{1.5in}
\begin{output}
Graph 3, order 5.
0 : 4;
1 : 4;
2 : ;
3 : ;
4 : 0 1;

\end{output}
\end{minipage}
&
\begin{minipage}{1.5in}
\begin{output}
Graph 7, order 5.
0 : 3 4;
1 : 3 4;
2 : ;
3 : 0 1;
4 : 0 1;

\end{output}
\end{minipage}
&
\begin{minipage}{1.5in}
\begin{output}
Graph 11, order 5.
0 : 2 4;
1 : 3 4;
2 : 0;
3 : 1;
4 : 0 1;

\end{output}
\end{minipage}
\\
\begin{minipage}{1.5in}
\begin{output}
Graph 4, order 5.
0 : 3 4;
1 : ;
2 : ;
3 : 0;
4 : 0;

\end{output}
\end{minipage}
&
\begin{minipage}{1.5in}
\begin{output}
Graph 8, order 5.
0 : 2 3 4;
1 : ;
2 : 0;
3 : 0;
4 : 0;

\end{output}
\end{minipage}
&
\begin{minipage}{1.5in}
\begin{output}
Graph 12, order 5.
0 : 2 3 4;
1 : 3 4;
2 : 0;
3 : 0 1;
4 : 0 1;

\end{output}
\end{minipage}
\\
&
&
\begin{minipage}{1.5in}
\begin{output}
Graph 13, order 5.
0 : 2 3 4;
1 : 2 3 4;
2 : 0 1;
3 : 0 1;
4 : 0 1;

\end{output}
\end{minipage}
\\
\end{tabular}


The first two vertices are from the first color and correspond to the vertices of our would-be hypergraphs.
The remaining three vertices are of the second color and correspond to the would-be hyperedges.
Clearly, there are some issues to work out. Firstly, note that \texttt{Graph 1} does not give us an actual hypergraph: both hyperedges would be empty, under our interpretation, which we do not allow. The same criticism holds for \texttt{Graph 2} and \texttt{Graph 3}.

To get around this, we use the command line switch $\texttt{-dm:n}$ where the \texttt{m} and \texttt{n} are the minimum degree of the first and second class of vertices, respectively.

With something like \texttt{-d0:1} we are saying that the vertices of our hypergraph may be in no hyperedges, but each hyperedge must contain at least 1 vertex, i.e. must not be empty.


\begin{code}
  $ ./genbg 2 3 -d0:1 | ./showg
\end{code}
The output is:

\begin{tabular}{|c|c|c|}
\begin{minipage}{1.5in}
\begin{output}
Graph 1, order 5.
  0 : 2 3 4;
  1 : ;
  2 : 0;
  3 : 0;
  4 : 0;

\end{output}
\end{minipage}

&

\begin{minipage}{1.5in}
\begin{output}
Graph 3, order 5.
  0 : 2 4;
  1 : 3;
  2 : 0;
  3 : 1;
  4 : 0;

\end{output}
\end{minipage}

&

\begin{minipage}{1.5in}
\begin{output}
Graph 5, order 5.
  0 : 2 3 4;
  1 : 3 4;
  2 : 0;
  3 : 0 1;
  4 : 0 1;

\end{output}
\end{minipage}

\\

\begin{minipage}{1.5in}
\begin{output}
Graph 2, order 5.
  0 : 2 3 4;
  1 : 4;
  2 : 0;
  3 : 0;
  4 : 0 1;

\end{output}
\end{minipage}

&

\begin{minipage}{1.5in}
\begin{output}
Graph 4, order 5.
  0 : 2 4;
  1 : 3 4;
  2 : 0;
  3 : 1;
  4 : 0 1;

\end{output}
\end{minipage}

&

\begin{minipage}{1.5in}
\begin{output}
Graph 6, order 5.
  0 : 2 3 4;
  1 : 2 3 4;
  2 : 0 1;
  3 : 0 1;
  4 : 0 1;
\end{output}
\end{minipage}

\\
\end{tabular}


There are still some issues. If we were to try to translate \texttt{Graph 1} to a hypergraph, we would get the same hyper edge three times. That is to say, we would end up with a hypergraph of only a single hyper edge. If we were interested in such a hypergraph, we would have just ran \texttt{./genbg 2 1 -d0:1} to begin with.

This issue is resolved with the command line switch \texttt{-z}, which makes sure that no two vertices in the second class can have the same neighborhood.

\begin{code}
  $ ./genbg 2 3 -z -d0:1 | ./showg
\end{code}
Which yields the output:

\begin{output}
Graph 1, order 5.
  0 : 2 4;
  1 : 3 4;
  2 : 0;
  3 : 1;
  4 : 0 1;

\end{output}
So in the end we have only a single hypergraph in this class. It has two vertices, each with it's own singleton hyperedge plus a hyperedge that contains both of the vertices.
Table \ref{tab:bipartite_hypergraph_correspondence} how this bipartite graph and it's corresponding hypergraph are related.

\begin{center}
\def\arraystretch{1.0}
\begin{table}
\begin{tabular}{c c}
  \def\svgwidth{0.45\columnwidth} \input{bipartite.pdf_tex}
  &
  \def\svgwidth{0.45\columnwidth} \input{hypergraph.pdf_tex}
\end{tabular}
\caption{The bipartite graph, and it's corresponding hypergraph.}
\label{tab:bipartite_hypergraph_correspondence}
\end{table}
\end{center}

Our hypothesis at this point is that a command such as \texttt{./genbg m n -z -d0:1} will generate all non-isomorphic hypergraphs of \texttt{m} vertices and \texttt{n} edges.

In other words we need to prove the following two results.

\begin{definition}
The \emph{neighbourhood} $\mathcal{N}(v) \subset V(G)$ of a vertex $v \in V(G)$ is defined as the set of vertices which have edges connected directly to $v$.
\end{definition}

\begin{definition}
A graph $G$ is said to be \emph{bipartite}, if there are $V_1, V_2 \subset{V(G)}$ such that $V(G) = V_1 \cup V_2$, such that $V_1 \cap V_2 = \emptyset$, and such that $\mathcal{N}(V_1) \subset V_2$ and $\mathcal{N}(V_2) \subset V_1$.
We denote these subsets by $V_1(G)$ and $V_2(G)$, and call them the \emph{first and second classes} of $G$, respectively.
\end{definition}

\begin{lemma}
Let $\mathfrak{B}$ be the set of all bipartite graphs where all vertices in the second class have distinct neighbourhoods.
Let $\mathfrak{H}$ be the set of all hypergraphs.
Then there is a bijection, up to isomorphism, between $\mathfrak{B}$ and $\mathfrak{H}$.
\end{lemma}
\begin{proof}
Let $G \in \mathfrak{B}$. Define $\varphi(G) = (V_1(G), \mathcal{N}(V_2(G))) \in \mathfrak{H}$.
In this way we have constructed a mapping from $\mathfrak{B}$ to $\mathfrak{H}$, which we claim has the desired properties.

\textbf{Injectivity:}
To show \emph{injectivity up to isomorphism}, we should show $G \cong G' \Leftrightarrow \varphi(G) \cong \varphi(G')$, for any two $G,G' \in \mathfrak{B}$.
Suppose that there is a graph isomorphism $f: G \isomarrow G'$.
Define $h: V_1(G) \rightarrow V_1(G')$ by $h(v) = f(v)$. In other words, $h$ is just $f$ restricted to $V_1(G)$.
We must now show that $h$ yields a bijection between $\mathcal{N}(V_2(G))$ and $\mathcal{N}(V_2(G'))$.
Since $\mathcal{N}(V_2(G)) \subset V_1(G)$ we get $h = f$ on $\mathcal{N}(V_2(G))$.
Now, since $f$ is an isomorphism, $f$ indeed yields a bijection between $\mathcal{N}(V_2(G))$ and $\mathcal{N}(V_2(G'))$. Therefore, so does $h$.
We have shown $G \cong G' \Rightarrow \varphi(G) \cong \varphi(G')$.
To show the converse, suppose that we have a hypergraph isomorphism between $h: \varphi(G) \isomarrow \varphi(G')$.
We define $f: G \rightarrow G'$ in two cases: $f \|_{V_1(G)} = h$ and $f \|_{V_2(G)} = \mathcal{N}^{-1} h \mathcal{N}$.
We should check that the second definition is well defined. All vertices in $V_2(G)$ have distinct neighbourhoods, which is just another way of saying that $\mathcal{N}$ yields a bijection between vertices in $V_2(G)$ and their neighbourhoods, for all $G$. We also have that $h$ forms a bijection between the neighbourhoods of $V_2(G)$ and $V_2(G')$, by it's definition. These two facts are sufficcient to show that $f \|_{V_1(G)}$ is well defined.
To show that $f$ is an isomorphism, we should check that whenever $v_1 \sim v_2$ in $G$, we get $f(v_1) \sim f(v_2)$ in $G'$, and vice-versa.
Suppose that $v_1 \sim v_2$ in $G$, where $v_1 \in V_1(G)$ and $v_2 \in V_2(G)$. It follows that $v_1 \in \mathcal{N}(v_2)$.
Therefore $h(v_1) \in h \mathcal{N}( v_2 )$, since $h$ is a bijection.
Now, $h(v_1) = f(v_1)$ and $h \mathcal{N} (v_2) = \mathcal{N} f (v_2) $, so we have $f(v_1) \in \mathcal{N} f (v_2)$, which implies $f(v_1) \sim f(v_2)$.
By symmetric reasoning (use $h^{-1}$ in place of $h$), we get $f(v_1) \sim f(v_2) \Rightarrow v_1 \sim v_2$.

\textbf{Surjectivity:}
To show \emph{surjectivity up to isomorphism}, we should show that, given any $H \in \mathfrak{H}$, there is a $G \in \mathfrak{B}$ such that $\varphi(G) \cong H$.
So let $H = (V, \mathcal{F}) \in \mathfrak{H}$ be any hypergraph.
Clearly, we can define a set $W$ such that $| W | = | \mathcal{F} |$ and $V \cap W = \emptyset$.
Since $| W | = | \mathcal{F} |$ is finite, there exists a bijection $\phi: W \rightarrow \mathcal{F}$.
We define $G \in \mathfrak{B}$ by $V_1(G) = V$, $V_2(G) = W$, and $v \sim w \Leftrightarrow v \in \phi(w)$, where $v \in V$ and $w \in W$.
By definition, we then have $\varphi(G) = (V, \mathcal{N}(W))$.
We take $h: \varphi(G) \rightarrow H$, given by $h \|_{V} = \text{id}$ and $h\|_{W} = \phi$, as a candidate for an isomorphism.
This is clearly a bijection, so it remains to be seen that it is a hypergraph isomorphism.
Given any $v \in V$ and $w \in W$, we get the followihg chain of equivalences:
$v \sim_{\varphi(G)} w \Leftrightarrow v \in \mathcal{N}(w) \Leftrightarrow v \sim_G w \Leftrightarrow v \in \phi(w) \Leftrightarrow h(v) \in h(w) \Leftrightarrow h(v) \sim_H h(w)$.
\qed
\end{proof}

We need a bit more precision, as provided by the following result, which follow immediately from the definition of $\varphi$.

\begin{corollary}
There is a bijection between the set of all non-isomorphic bipartite graphs in $\mathfrak{B}$ with $m$ vertices in the first class and $n$ vertices in the second class, and the set of all non-isomorphic hypergraphs with $n$ vertices and $m$ hyperedges.
\end{corollary}

\begin{corollary}
Given any two integers $d \leq D$, there is a bijection between the set of all non-isomorphic bipartite graphs $G \in \mathfrak{B}$ with $d \leq | \mathcal{N}(v) | \leq D$ for all $v \in V_2(G)$, and the set of all hypergraphs $H = (V, \mathcal{F}) \in \mathfrak{H}$ with $d \leq | W | \leq D$, for all $W \in \mathcal{F}$.
\end{corollary}
